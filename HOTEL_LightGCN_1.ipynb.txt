{
  "cells": [
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "fTNafVziL2A_",
        "outputId": "bb063500-d93d-43f5-b21e-78bbf80f2f79"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Requirement already satisfied: LibRecommender in /usr/local/lib/python3.10/dist-packages (1.5.1)\n",
            "Requirement already satisfied: gensim>=4.0.0 in /usr/local/lib/python3.10/dist-packages (from LibRecommender) (4.3.2)\n",
            "Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from LibRecommender) (4.66.4)\n",
            "Requirement already satisfied: numpy>=1.18.5 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender) (1.25.2)\n",
            "Requirement already satisfied: scipy>=1.7.0 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender) (1.11.4)\n",
            "Requirement already satisfied: smart-open>=1.8.1 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender) (7.0.4)\n",
            "Requirement already satisfied: wrapt in /usr/local/lib/python3.10/dist-packages (from smart-open>=1.8.1->gensim>=4.0.0->LibRecommender) (1.14.1)\n"
          ]
        }
      ],
      "source": [
        "pip install -U LibRecommender"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "3v3HnyusNRxz",
        "outputId": "c7d158e7-ccdc-4d21-c58e-4f73175e7be0"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Collecting git+https://github.com/massquantity/LibRecommender.git\n",
            "  Cloning https://github.com/massquantity/LibRecommender.git to /tmp/pip-req-build-ofqovaeg\n",
            "  Running command git clone --filter=blob:none --quiet https://github.com/massquantity/LibRecommender.git /tmp/pip-req-build-ofqovaeg\n",
            "  Resolved https://github.com/massquantity/LibRecommender.git to commit fe662e0b17cd294efe6368a193ee4156344a4038\n",
            "  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n",
            "  Getting requirements to build wheel ... \u001b[?25l\u001b[?25hdone\n",
            "  Preparing metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n",
            "Requirement already satisfied: gensim>=4.0.0 in /usr/local/lib/python3.10/dist-packages (from LibRecommender==1.5.1) (4.3.2)\n",
            "Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from LibRecommender==1.5.1) (4.66.4)\n",
            "Requirement already satisfied: numpy>=1.18.5 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender==1.5.1) (1.25.2)\n",
            "Requirement already satisfied: scipy>=1.7.0 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender==1.5.1) (1.11.4)\n",
            "Requirement already satisfied: smart-open>=1.8.1 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender==1.5.1) (7.0.4)\n",
            "Requirement already satisfied: wrapt in /usr/local/lib/python3.10/dist-packages (from smart-open>=1.8.1->gensim>=4.0.0->LibRecommender==1.5.1) (1.14.1)\n"
          ]
        }
      ],
      "source": [
        "pip install git+https://github.com/massquantity/LibRecommender.git"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "ntseR-W9NV_6",
        "outputId": "4bd8f98a-fac6-46b0-f271-8fe24d3406b3"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Cloning into 'LibRecommender'...\n",
            "remote: Enumerating objects: 9624, done.\u001b[K\n",
            "remote: Counting objects: 100% (507/507), done.\u001b[K\n",
            "remote: Compressing objects: 100% (181/181), done.\u001b[K\n",
            "remote: Total 9624 (delta 357), reused 430 (delta 309), pack-reused 9117\u001b[K\n",
            "Receiving objects: 100% (9624/9624), 10.89 MiB | 12.10 MiB/s, done.\n",
            "Resolving deltas: 100% (6573/6573), done.\n"
          ]
        }
      ],
      "source": [
        "!git clone https://github.com/massquantity/LibRecommender.git\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "iGkollFnNx-0",
        "outputId": "9602afba-8c8c-4a3b-bfe0-7ac5c2c56045"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "/content/LibRecommender\n"
          ]
        }
      ],
      "source": [
        "cd LibRecommender\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "44onwBYnN3Ee",
        "outputId": "e0e92695-42cd-4d1e-eec2-14ab097f309e"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Using pip 23.1.2 from /usr/local/lib/python3.10/dist-packages/pip (python 3.10)\n",
            "Non-user install because site-packages writeable\n",
            "Created temporary directory: /tmp/pip-build-tracker-0q8r5sg1\n",
            "Initialized build tracking at /tmp/pip-build-tracker-0q8r5sg1\n",
            "Created build tracker: /tmp/pip-build-tracker-0q8r5sg1\n",
            "Entered build tracker: /tmp/pip-build-tracker-0q8r5sg1\n",
            "Created temporary directory: /tmp/pip-install-2o055959\n",
            "Created temporary directory: /tmp/pip-ephem-wheel-cache-pqiodsdu\n",
            "Obtaining file:///content/LibRecommender\n",
            "  Added file:///content/LibRecommender to build tracker '/tmp/pip-build-tracker-0q8r5sg1'\n",
            "  Created temporary directory: /tmp/pip-build-env-h43dim8o\n",
            "  Running command pip subprocess to install build dependencies\n",
            "  Using pip 23.1.2 from /usr/local/lib/python3.10/dist-packages/pip (python 3.10)\n",
            "  Collecting setuptools>=54.0.0\n",
            "    Using cached setuptools-71.1.0-py3-none-any.whl (2.3 MB)\n",
            "  Collecting wheel\n",
            "    Using cached wheel-0.43.0-py3-none-any.whl (65 kB)\n",
            "  Collecting Cython<3,>=0.29.0\n",
            "    Using cached Cython-0.29.37-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.manylinux_2_24_x86_64.whl (1.9 MB)\n",
            "  Collecting numpy>=1.19.5\n",
            "    Using cached numpy-2.0.1-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (19.5 MB)\n",
            "    Link requires a different Python (3.10.12 not in: '>=3.7,<3.10'): https://files.pythonhosted.org/packages/99/f1/c00d6be56e1a718a3068079e3ec8ce044d7179345280f6a3f5066068af0d/scipy-1.6.2.tar.gz (from https://pypi.org/simple/scipy/) (requires-python:>=3.7,<3.10)\n",
            "    Link requires a different Python (3.10.12 not in: '>=3.7,<3.10'): https://files.pythonhosted.org/packages/fe/fd/8704c7b7b34cdac850485e638346025ca57c5a859934b9aa1be5399b33b7/scipy-1.6.3.tar.gz (from https://pypi.org/simple/scipy/) (requires-python:>=3.7,<3.10)\n",
            "    Link requires a different Python (3.10.12 not in: '>=3.7,<3.10'): https://files.pythonhosted.org/packages/bb/bb/944f559d554df6c9adf037aa9fc982a9706ee0e96c0d5beac701cb158900/scipy-1.7.0.tar.gz (from https://pypi.org/simple/scipy/) (requires-python:>=3.7,<3.10)\n",
            "    Link requires a different Python (3.10.12 not in: '>=3.7,<3.10'): https://files.pythonhosted.org/packages/47/33/a24aec22b7be7fdb10ec117a95e1e4099890d8bbc6646902f443fc7719d1/scipy-1.7.1.tar.gz (from https://pypi.org/simple/scipy/) (requires-python:>=3.7,<3.10)\n",
            "  Collecting scipy>=1.2.1\n",
            "    Using cached scipy-1.14.0-cp310-cp310-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (41.1 MB)\n",
            "  Collecting tomli\n",
            "    Using cached tomli-2.0.1-py3-none-any.whl (12 kB)\n",
            "  Installing collected packages: wheel, tomli, setuptools, numpy, Cython, scipy\n",
            "    Creating /tmp/pip-build-env-h43dim8o/overlay/local/bin\n",
            "    changing mode of /tmp/pip-build-env-h43dim8o/overlay/local/bin/wheel to 755\n",
            "    changing mode of /tmp/pip-build-env-h43dim8o/overlay/local/bin/f2py to 755\n",
            "    changing mode of /tmp/pip-build-env-h43dim8o/overlay/local/bin/numpy-config to 755\n",
            "    changing mode of /tmp/pip-build-env-h43dim8o/overlay/local/bin/cygdb to 755\n",
            "    changing mode of /tmp/pip-build-env-h43dim8o/overlay/local/bin/cython to 755\n",
            "    changing mode of /tmp/pip-build-env-h43dim8o/overlay/local/bin/cythonize to 755\n",
            "  ERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\n",
            "  ipython 7.34.0 requires jedi>=0.16, which is not installed.\n",
            "  accelerate 0.32.1 requires numpy<2.0.0,>=1.17, but you have numpy 2.0.1 which is incompatible.\n",
            "  astropy 5.3.4 requires numpy<2,>=1.21, but you have numpy 2.0.1 which is incompatible.\n",
            "  cudf-cu12 24.4.1 requires numpy<2.0a0,>=1.23, but you have numpy 2.0.1 which is incompatible.\n",
            "  cupy-cuda12x 12.2.0 requires numpy<1.27,>=1.20, but you have numpy 2.0.1 which is incompatible.\n",
            "  ibis-framework 8.0.0 requires numpy<2,>=1, but you have numpy 2.0.1 which is incompatible.\n",
            "  numba 0.58.1 requires numpy<1.27,>=1.22, but you have numpy 2.0.1 which is incompatible.\n",
            "  rmm-cu12 24.4.0 requires numpy<2.0a0,>=1.23, but you have numpy 2.0.1 which is incompatible.\n",
            "  tensorflow 2.15.0 requires numpy<2.0.0,>=1.23.5, but you have numpy 2.0.1 which is incompatible.\n",
            "  thinc 8.2.5 requires numpy<2.0.0,>=1.19.0; python_version >= \"3.9\", but you have numpy 2.0.1 which is incompatible.\n",
            "  transformers 4.42.4 requires numpy<2.0,>=1.17, but you have numpy 2.0.1 which is incompatible.\n",
            "  Successfully installed Cython-0.29.37 numpy-2.0.1 scipy-1.14.0 setuptools-71.1.0 tomli-2.0.1 wheel-0.43.0\n",
            "  Installing build dependencies ... \u001b[?25l\u001b[?25hdone\n",
            "  Running command Checking if build backend supports build_editable\n",
            "  Checking if build backend supports build_editable ... \u001b[?25l\u001b[?25hdone\n",
            "  Running command Getting requirements to build editable\n",
            "  Compiling libreco/algorithms/_bpr.pyx because it changed.\n",
            "  Compiling libreco/algorithms/_als.pyx because it changed.\n",
            "  Compiling libreco/utils/_similarities.pyx because it changed.\n",
            "  [1/3] Cythonizing libreco/algorithms/_als.pyx\n",
            "  [2/3] Cythonizing libreco/algorithms/_bpr.pyx\n",
            "  [3/3] Cythonizing libreco/utils/_similarities.pyx\n",
            "  running egg_info\n",
            "  creating LibRecommender.egg-info\n",
            "  writing LibRecommender.egg-info/PKG-INFO\n",
            "  writing dependency_links to LibRecommender.egg-info/dependency_links.txt\n",
            "  writing requirements to LibRecommender.egg-info/requires.txt\n",
            "  writing top-level names to LibRecommender.egg-info/top_level.txt\n",
            "  writing manifest file 'LibRecommender.egg-info/SOURCES.txt'\n",
            "  reading manifest file 'LibRecommender.egg-info/SOURCES.txt'\n",
            "  reading manifest template 'MANIFEST.in'\n",
            "  warning: no files found matching '*.c' under directory 'libreco'\n",
            "  warning: no files found matching '*.sh' under directory 'libserving'\n",
            "  warning: no previously-included files matching '*' found under directory 'examples'\n",
            "  warning: no previously-included files matching '*' found under directory 'distributed'\n",
            "  adding license file 'LICENSE'\n",
            "  writing manifest file 'LibRecommender.egg-info/SOURCES.txt'\n",
            "  Getting requirements to build editable ... \u001b[?25l\u001b[?25hdone\n",
            "  Created temporary directory: /tmp/pip-modern-metadata-niykp4td\n",
            "  Running command Preparing editable metadata (pyproject.toml)\n",
            "  running dist_info\n",
            "  creating /tmp/pip-modern-metadata-niykp4td/LibRecommender.egg-info\n",
            "  writing /tmp/pip-modern-metadata-niykp4td/LibRecommender.egg-info/PKG-INFO\n",
            "  writing dependency_links to /tmp/pip-modern-metadata-niykp4td/LibRecommender.egg-info/dependency_links.txt\n",
            "  writing requirements to /tmp/pip-modern-metadata-niykp4td/LibRecommender.egg-info/requires.txt\n",
            "  writing top-level names to /tmp/pip-modern-metadata-niykp4td/LibRecommender.egg-info/top_level.txt\n",
            "  writing manifest file '/tmp/pip-modern-metadata-niykp4td/LibRecommender.egg-info/SOURCES.txt'\n",
            "  reading manifest file '/tmp/pip-modern-metadata-niykp4td/LibRecommender.egg-info/SOURCES.txt'\n",
            "  reading manifest template 'MANIFEST.in'\n",
            "  warning: no files found matching '*.c' under directory 'libreco'\n",
            "  warning: no files found matching '*.sh' under directory 'libserving'\n",
            "  warning: no previously-included files matching '*' found under directory 'examples'\n",
            "  warning: no previously-included files matching '*' found under directory 'distributed'\n",
            "  adding license file 'LICENSE'\n",
            "  writing manifest file '/tmp/pip-modern-metadata-niykp4td/LibRecommender.egg-info/SOURCES.txt'\n",
            "  creating '/tmp/pip-modern-metadata-niykp4td/LibRecommender-1.5.1.dist-info'\n",
            "  Preparing editable metadata (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n",
            "  Source in /content/LibRecommender has version 1.5.1, which satisfies requirement LibRecommender==1.5.1 from file:///content/LibRecommender\n",
            "  Removed LibRecommender==1.5.1 from file:///content/LibRecommender from build tracker '/tmp/pip-build-tracker-0q8r5sg1'\n",
            "Requirement already satisfied: gensim>=4.0.0 in /usr/local/lib/python3.10/dist-packages (from LibRecommender==1.5.1) (4.3.2)\n",
            "Requirement already satisfied: tqdm in /usr/local/lib/python3.10/dist-packages (from LibRecommender==1.5.1) (4.66.4)\n",
            "Requirement already satisfied: numpy>=1.18.5 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender==1.5.1) (1.25.2)\n",
            "Requirement already satisfied: scipy>=1.7.0 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender==1.5.1) (1.11.4)\n",
            "Requirement already satisfied: smart-open>=1.8.1 in /usr/local/lib/python3.10/dist-packages (from gensim>=4.0.0->LibRecommender==1.5.1) (7.0.4)\n",
            "Requirement already satisfied: wrapt in /usr/local/lib/python3.10/dist-packages (from smart-open>=1.8.1->gensim>=4.0.0->LibRecommender==1.5.1) (1.14.1)\n",
            "Created temporary directory: /tmp/pip-unpack-luzei7py\n",
            "Building wheels for collected packages: LibRecommender\n",
            "  Created temporary directory: /tmp/pip-wheel-p6vzdsz6\n",
            "  Destination directory: /tmp/pip-wheel-p6vzdsz6\n",
            "  Running command Building editable for LibRecommender (pyproject.toml)\n",
            "  running editable_wheel\n",
            "  creating /tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender.egg-info\n",
            "  writing /tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender.egg-info/PKG-INFO\n",
            "  writing dependency_links to /tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender.egg-info/dependency_links.txt\n",
            "  writing requirements to /tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender.egg-info/requires.txt\n",
            "  writing top-level names to /tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender.egg-info/top_level.txt\n",
            "  writing manifest file '/tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender.egg-info/SOURCES.txt'\n",
            "  reading manifest file '/tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender.egg-info/SOURCES.txt'\n",
            "  reading manifest template 'MANIFEST.in'\n",
            "  warning: no files found matching '*.c' under directory 'libreco'\n",
            "  warning: no files found matching '*.sh' under directory 'libserving'\n",
            "  warning: no previously-included files matching '*' found under directory 'examples'\n",
            "  warning: no previously-included files matching '*' found under directory 'distributed'\n",
            "  adding license file 'LICENSE'\n",
            "  writing manifest file '/tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender.egg-info/SOURCES.txt'\n",
            "  creating '/tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender-1.5.1.dist-info'\n",
            "  creating /tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender-1.5.1.dist-info/WHEEL\n",
            "  running build_py\n",
            "  running build_ext\n",
            "  building 'libreco.algorithms._bpr' extension\n",
            "  creating /tmp/tmp9afmydu0.build-temp/libreco\n",
            "  creating /tmp/tmp9afmydu0.build-temp/libreco/algorithms\n",
            "  x86_64-linux-gnu-gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/tmp/pip-build-env-h43dim8o/overlay/local/lib/python3.10/dist-packages/numpy/_core/include -I/usr/include/python3.10 -c libreco/algorithms/_bpr.cpp -o /tmp/tmp9afmydu0.build-temp/libreco/algorithms/_bpr.o -Wno-unused-function -Wno-maybe-uninitialized -O3 -ffast-math -fopenmp -std=c++11\n",
            "  x86_64-linux-gnu-g++ -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -g -fwrapv -O2 /tmp/tmp9afmydu0.build-temp/libreco/algorithms/_bpr.o -L/usr/lib/x86_64-linux-gnu -o /content/LibRecommender/libreco/algorithms/_bpr.cpython-310-x86_64-linux-gnu.so -fopenmp -std=c++11\n",
            "  building 'libreco.algorithms._als' extension\n",
            "  x86_64-linux-gnu-gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/tmp/pip-build-env-h43dim8o/overlay/local/lib/python3.10/dist-packages/numpy/_core/include -I/usr/include/python3.10 -c libreco/algorithms/_als.cpp -o /tmp/tmp9afmydu0.build-temp/libreco/algorithms/_als.o -Wno-unused-function -Wno-maybe-uninitialized -O3 -ffast-math -fopenmp -std=c++11\n",
            "  x86_64-linux-gnu-g++ -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -g -fwrapv -O2 /tmp/tmp9afmydu0.build-temp/libreco/algorithms/_als.o -L/usr/lib/x86_64-linux-gnu -o /content/LibRecommender/libreco/algorithms/_als.cpython-310-x86_64-linux-gnu.so -fopenmp -std=c++11\n",
            "  building 'libreco.utils._similarities' extension\n",
            "  creating /tmp/tmp9afmydu0.build-temp/libreco/utils\n",
            "  x86_64-linux-gnu-gcc -Wno-unused-result -Wsign-compare -DNDEBUG -g -fwrapv -O2 -Wall -g -fstack-protector-strong -Wformat -Werror=format-security -g -fwrapv -O2 -fPIC -I/tmp/pip-build-env-h43dim8o/overlay/local/lib/python3.10/dist-packages/numpy/_core/include -I/usr/include/python3.10 -c libreco/utils/_similarities.cpp -o /tmp/tmp9afmydu0.build-temp/libreco/utils/_similarities.o -Wno-unused-function -Wno-maybe-uninitialized -O3 -ffast-math -fopenmp -std=c++11\n",
            "  In file included from /tmp/pip-build-env-h43dim8o/overlay/local/lib/python3.10/dist-packages/numpy/_core/include/numpy/ndarraytypes.h:1909,\n",
            "                   from /tmp/pip-build-env-h43dim8o/overlay/local/lib/python3.10/dist-packages/numpy/_core/include/numpy/ndarrayobject.h:12,\n",
            "                   from /tmp/pip-build-env-h43dim8o/overlay/local/lib/python3.10/dist-packages/numpy/_core/include/numpy/arrayobject.h:5,\n",
            "                   from libreco/utils/_similarities.cpp:804:\n",
            "  /tmp/pip-build-env-h43dim8o/overlay/local/lib/python3.10/dist-packages/numpy/_core/include/numpy/npy_1_7_deprecated_api.h:17:2: warning: #warning \"Using deprecated NumPy API, disable it with \" \"#define NPY_NO_DEPRECATED_API NPY_1_7_API_VERSION\" [-Wcpp]\n",
            "     17 | #warning \"Using deprecated NumPy API, disable it with \" \\\n",
            "        |  ^~~~~~~\n",
            "  x86_64-linux-gnu-g++ -shared -Wl,-O1 -Wl,-Bsymbolic-functions -Wl,-Bsymbolic-functions -g -fwrapv -O2 /tmp/tmp9afmydu0.build-temp/libreco/utils/_similarities.o -L/usr/lib/x86_64-linux-gnu -o /content/LibRecommender/libreco/utils/_similarities.cpython-310-x86_64-linux-gnu.so -fopenmp -std=c++11\n",
            "  running egg_info\n",
            "  creating /tmp/tmp9afmydu0.build-temp/LibRecommender.egg-info\n",
            "  writing /tmp/tmp9afmydu0.build-temp/LibRecommender.egg-info/PKG-INFO\n",
            "  writing dependency_links to /tmp/tmp9afmydu0.build-temp/LibRecommender.egg-info/dependency_links.txt\n",
            "  writing requirements to /tmp/tmp9afmydu0.build-temp/LibRecommender.egg-info/requires.txt\n",
            "  writing top-level names to /tmp/tmp9afmydu0.build-temp/LibRecommender.egg-info/top_level.txt\n",
            "  writing manifest file '/tmp/tmp9afmydu0.build-temp/LibRecommender.egg-info/SOURCES.txt'\n",
            "  reading manifest file '/tmp/tmp9afmydu0.build-temp/LibRecommender.egg-info/SOURCES.txt'\n",
            "  reading manifest template 'MANIFEST.in'\n",
            "  warning: no files found matching '*.c' under directory 'libreco'\n",
            "  warning: no files found matching '*.sh' under directory 'libserving'\n",
            "  warning: no previously-included files matching '*' found under directory 'examples'\n",
            "  warning: no previously-included files matching '*' found under directory 'distributed'\n",
            "  adding license file 'LICENSE'\n",
            "  writing manifest file '/tmp/tmp9afmydu0.build-temp/LibRecommender.egg-info/SOURCES.txt'\n",
            "  Editable install will be performed using a meta path finder.\n",
            "\n",
            "  Options like `package-data`, `include/exclude-package-data` or\n",
            "  `packages.find.exclude/include` may have no effect.\n",
            "\n",
            "  adding '__editable___LibRecommender_1_5_1_finder.py'\n",
            "  adding '__editable__.LibRecommender-1.5.1.pth'\n",
            "  creating '/tmp/pip-wheel-p6vzdsz6/.tmp-6j2g66ne/LibRecommender-1.5.1-0.editable-cp310-cp310-linux_x86_64.whl' and adding '/tmp/tmp5xio2ylcLibRecommender-1.5.1-0.editable-cp310-cp310-linux_x86_64.whl' to it\n",
            "  adding 'LibRecommender-1.5.1.dist-info/LICENSE'\n",
            "  adding 'LibRecommender-1.5.1.dist-info/METADATA'\n",
            "  adding 'LibRecommender-1.5.1.dist-info/WHEEL'\n",
            "  adding 'LibRecommender-1.5.1.dist-info/top_level.txt'\n",
            "  adding 'LibRecommender-1.5.1.dist-info/RECORD'\n",
            "  /tmp/pip-build-env-h43dim8o/overlay/local/lib/python3.10/dist-packages/setuptools/command/editable_wheel.py:357: InformationOnly: Editable installation.\n",
            "  !!\n",
            "\n",
            "          ********************************************************************************\n",
            "          Please be careful with folders in your working directory with the same\n",
            "          name as your package as they may take precedence during imports.\n",
            "          ********************************************************************************\n",
            "\n",
            "  !!\n",
            "    with strategy, WheelFile(wheel_path, \"w\") as wheel_obj:\n",
            "  Building editable for LibRecommender (pyproject.toml) ... \u001b[?25l\u001b[?25hdone\n",
            "  Created wheel for LibRecommender: filename=LibRecommender-1.5.1-0.editable-cp310-cp310-linux_x86_64.whl size=10098 sha256=2d610e955525a302096ea1a5bdea82304d45933247dda7ada05d0dc3514fad62\n",
            "  Stored in directory: /tmp/pip-ephem-wheel-cache-pqiodsdu/wheels/77/1d/d9/4fb4b7f202e80009c1648a4e31c56ec57f28d01b42649b5883\n",
            "Successfully built LibRecommender\n",
            "Installing collected packages: LibRecommender\n",
            "  Attempting uninstall: LibRecommender\n",
            "    Found existing installation: LibRecommender 1.5.1\n",
            "    Uninstalling LibRecommender-1.5.1:\n",
            "      Created temporary directory: /usr/local/lib/python3.10/dist-packages/~ibRecommender-1.5.1.dist-info\n",
            "      Removing file or directory /usr/local/lib/python3.10/dist-packages/LibRecommender-1.5.1.dist-info/\n",
            "      Created temporary directory: /usr/local/lib/python3.10/dist-packages/~ibRecommender.libs\n",
            "      Removing file or directory /usr/local/lib/python3.10/dist-packages/LibRecommender.libs/\n",
            "      Created temporary directory: /usr/local/lib/python3.10/dist-packages/~ibreco\n",
            "      Removing file or directory /usr/local/lib/python3.10/dist-packages/libreco/\n",
            "      Created temporary directory: /usr/local/lib/python3.10/dist-packages/~ibserving\n",
            "      Removing file or directory /usr/local/lib/python3.10/dist-packages/libserving/\n",
            "      Successfully uninstalled LibRecommender-1.5.1\n",
            "\n",
            "Successfully installed LibRecommender-1.5.1\n",
            "Removed build tracker: '/tmp/pip-build-tracker-0q8r5sg1'\n"
          ]
        }
      ],
      "source": [
        "pip install -e . -vv"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "KMQwqjPQLG8w",
        "outputId": "a095ef97-86eb-4464-a09f-337ab4067039"
      },
      "outputs": [
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "WARNING:tensorflow:From /usr/local/lib/python3.10/dist-packages/tensorflow/python/compat/v2_compat.py:108: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.\n",
            "Instructions for updating:\n",
            "non-resource variables are not supported in the long term\n"
          ]
        }
      ],
      "source": [
        "import numpy as np\n",
        "import pandas as pd\n",
        "from libreco.data import random_split, DatasetPure\n",
        "from libreco.algorithms import LightGCN  # pure data, algorithm LightGCN\n",
        "from libreco.evaluation import evaluate\n",
        "from io import StringIO"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "zsOgH3SWTsl1"
      },
      "source": []
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "RNlBmYAmVEC8"
      },
      "outputs": [],
      "source": [
        "url = \"/content/data asli.csv\"\n"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/",
          "height": 424
        },
        "id": "KiRsHKUALH2V",
        "outputId": "ac73d102-7f15-4a98-f7eb-7bce7b9080a8"
      },
      "outputs": [
        {
          "data": {
            "application/vnd.google.colaboratory.intrinsic+json": {
              "summary": "{\n  \"name\": \"data\",\n  \"rows\": 2000,\n  \"fields\": [\n    {\n      \"column\": \"user\",\n      \"properties\": {\n        \"dtype\": \"string\",\n        \"num_unique_values\": 1845,\n        \"samples\": [\n          \"eka_w\",\n          \"Rosaliya_D\",\n          \"Muhammad_L\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"item\",\n      \"properties\": {\n        \"dtype\": \"category\",\n        \"num_unique_values\": 200,\n        \"samples\": [\n          \"Loft Legian Hotel\",\n          \"Horison Seminyak\",\n          \"Kanvaz Village Resort Seminyak\"\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    },\n    {\n      \"column\": \"label\",\n      \"properties\": {\n        \"dtype\": \"number\",\n        \"std\": 1.090432124714466,\n        \"min\": 4.5,\n        \"max\": 10.0,\n        \"num_unique_values\": 40,\n        \"samples\": [\n          5.2,\n          8.6,\n          6.2\n        ],\n        \"semantic_type\": \"\",\n        \"description\": \"\"\n      }\n    }\n  ]\n}",
              "type": "dataframe",
              "variable_name": "data"
            },
            "text/html": [
              "\n",
              "  <div id=\"df-69d1fbe1-be8d-4090-92dc-0b335f8fea1e\" class=\"colab-df-container\">\n",
              "    <div>\n",
              "<style scoped>\n",
              "    .dataframe tbody tr th:only-of-type {\n",
              "        vertical-align: middle;\n",
              "    }\n",
              "\n",
              "    .dataframe tbody tr th {\n",
              "        vertical-align: top;\n",
              "    }\n",
              "\n",
              "    .dataframe thead th {\n",
              "        text-align: right;\n",
              "    }\n",
              "</style>\n",
              "<table border=\"1\" class=\"dataframe\">\n",
              "  <thead>\n",
              "    <tr style=\"text-align: right;\">\n",
              "      <th></th>\n",
              "      <th>user</th>\n",
              "      <th>item</th>\n",
              "      <th>label</th>\n",
              "    </tr>\n",
              "  </thead>\n",
              "  <tbody>\n",
              "    <tr>\n",
              "      <th>0</th>\n",
              "      <td>Tiagarajen</td>\n",
              "      <td>Samudra Boutique Hotel and Villa</td>\n",
              "      <td>6.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1</th>\n",
              "      <td>sandro_p</td>\n",
              "      <td>Samudra Boutique Hotel and Villa</td>\n",
              "      <td>6.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>2</th>\n",
              "      <td>Yefta_I</td>\n",
              "      <td>Samudra Boutique Hotel and Villa</td>\n",
              "      <td>5.1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>3</th>\n",
              "      <td>Regina_T_C</td>\n",
              "      <td>Samudra Boutique Hotel and Villa</td>\n",
              "      <td>4.8</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>4</th>\n",
              "      <td>Fiko_B</td>\n",
              "      <td>Samudra Boutique Hotel and Villa</td>\n",
              "      <td>5.1</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>...</th>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "      <td>...</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1995</th>\n",
              "      <td>Daud_Y</td>\n",
              "      <td>Le Meridien Bali Jimbaran - CHSE Certified</td>\n",
              "      <td>10.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1996</th>\n",
              "      <td>zatalia_r</td>\n",
              "      <td>Le Meridien Bali Jimbaran - CHSE Certified</td>\n",
              "      <td>10.0</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1997</th>\n",
              "      <td>Aulia_M</td>\n",
              "      <td>Le Meridien Bali Jimbaran - CHSE Certified</td>\n",
              "      <td>9.7</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1998</th>\n",
              "      <td>Aulia_M</td>\n",
              "      <td>Le Meridien Bali Jimbaran - CHSE Certified</td>\n",
              "      <td>9.7</td>\n",
              "    </tr>\n",
              "    <tr>\n",
              "      <th>1999</th>\n",
              "      <td>Fieckaa_E</td>\n",
              "      <td>Le Meridien Bali Jimbaran - CHSE Certified</td>\n",
              "      <td>9.7</td>\n",
              "    </tr>\n",
              "  </tbody>\n",
              "</table>\n",
              "<p>2000 rows × 3 columns</p>\n",
              "</div>\n",
              "    <div class=\"colab-df-buttons\">\n",
              "\n",
              "  <div class=\"colab-df-container\">\n",
              "    <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-69d1fbe1-be8d-4090-92dc-0b335f8fea1e')\"\n",
              "            title=\"Convert this dataframe to an interactive table.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\">\n",
              "    <path d=\"M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "\n",
              "  <style>\n",
              "    .colab-df-container {\n",
              "      display:flex;\n",
              "      gap: 12px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert {\n",
              "      background-color: #E8F0FE;\n",
              "      border: none;\n",
              "      border-radius: 50%;\n",
              "      cursor: pointer;\n",
              "      display: none;\n",
              "      fill: #1967D2;\n",
              "      height: 32px;\n",
              "      padding: 0 0 0 0;\n",
              "      width: 32px;\n",
              "    }\n",
              "\n",
              "    .colab-df-convert:hover {\n",
              "      background-color: #E2EBFA;\n",
              "      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "      fill: #174EA6;\n",
              "    }\n",
              "\n",
              "    .colab-df-buttons div {\n",
              "      margin-bottom: 4px;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert {\n",
              "      background-color: #3B4455;\n",
              "      fill: #D2E3FC;\n",
              "    }\n",
              "\n",
              "    [theme=dark] .colab-df-convert:hover {\n",
              "      background-color: #434B5C;\n",
              "      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "      fill: #FFFFFF;\n",
              "    }\n",
              "  </style>\n",
              "\n",
              "    <script>\n",
              "      const buttonEl =\n",
              "        document.querySelector('#df-69d1fbe1-be8d-4090-92dc-0b335f8fea1e button.colab-df-convert');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      async function convertToInteractive(key) {\n",
              "        const element = document.querySelector('#df-69d1fbe1-be8d-4090-92dc-0b335f8fea1e');\n",
              "        const dataTable =\n",
              "          await google.colab.kernel.invokeFunction('convertToInteractive',\n",
              "                                                    [key], {});\n",
              "        if (!dataTable) return;\n",
              "\n",
              "        const docLinkHtml = 'Like what you see? Visit the ' +\n",
              "          '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n",
              "          + ' to learn more about interactive tables.';\n",
              "        element.innerHTML = '';\n",
              "        dataTable['output_type'] = 'display_data';\n",
              "        await google.colab.output.renderOutput(dataTable, element);\n",
              "        const docLink = document.createElement('div');\n",
              "        docLink.innerHTML = docLinkHtml;\n",
              "        element.appendChild(docLink);\n",
              "      }\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "\n",
              "<div id=\"df-9ba6503e-e853-4c67-abf1-26f826d8e35b\">\n",
              "  <button class=\"colab-df-quickchart\" onclick=\"quickchart('df-9ba6503e-e853-4c67-abf1-26f826d8e35b')\"\n",
              "            title=\"Suggest charts\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "     width=\"24px\">\n",
              "    <g>\n",
              "        <path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z\"/>\n",
              "    </g>\n",
              "</svg>\n",
              "  </button>\n",
              "\n",
              "<style>\n",
              "  .colab-df-quickchart {\n",
              "      --bg-color: #E8F0FE;\n",
              "      --fill-color: #1967D2;\n",
              "      --hover-bg-color: #E2EBFA;\n",
              "      --hover-fill-color: #174EA6;\n",
              "      --disabled-fill-color: #AAA;\n",
              "      --disabled-bg-color: #DDD;\n",
              "  }\n",
              "\n",
              "  [theme=dark] .colab-df-quickchart {\n",
              "      --bg-color: #3B4455;\n",
              "      --fill-color: #D2E3FC;\n",
              "      --hover-bg-color: #434B5C;\n",
              "      --hover-fill-color: #FFFFFF;\n",
              "      --disabled-bg-color: #3B4455;\n",
              "      --disabled-fill-color: #666;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart {\n",
              "    background-color: var(--bg-color);\n",
              "    border: none;\n",
              "    border-radius: 50%;\n",
              "    cursor: pointer;\n",
              "    display: none;\n",
              "    fill: var(--fill-color);\n",
              "    height: 32px;\n",
              "    padding: 0;\n",
              "    width: 32px;\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart:hover {\n",
              "    background-color: var(--hover-bg-color);\n",
              "    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "    fill: var(--button-hover-fill-color);\n",
              "  }\n",
              "\n",
              "  .colab-df-quickchart-complete:disabled,\n",
              "  .colab-df-quickchart-complete:disabled:hover {\n",
              "    background-color: var(--disabled-bg-color);\n",
              "    fill: var(--disabled-fill-color);\n",
              "    box-shadow: none;\n",
              "  }\n",
              "\n",
              "  .colab-df-spinner {\n",
              "    border: 2px solid var(--fill-color);\n",
              "    border-color: transparent;\n",
              "    border-bottom-color: var(--fill-color);\n",
              "    animation:\n",
              "      spin 1s steps(1) infinite;\n",
              "  }\n",
              "\n",
              "  @keyframes spin {\n",
              "    0% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "      border-left-color: var(--fill-color);\n",
              "    }\n",
              "    20% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    30% {\n",
              "      border-color: transparent;\n",
              "      border-left-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    40% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-top-color: var(--fill-color);\n",
              "    }\n",
              "    60% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "    }\n",
              "    80% {\n",
              "      border-color: transparent;\n",
              "      border-right-color: var(--fill-color);\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "    90% {\n",
              "      border-color: transparent;\n",
              "      border-bottom-color: var(--fill-color);\n",
              "    }\n",
              "  }\n",
              "</style>\n",
              "\n",
              "  <script>\n",
              "    async function quickchart(key) {\n",
              "      const quickchartButtonEl =\n",
              "        document.querySelector('#' + key + ' button');\n",
              "      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.\n",
              "      quickchartButtonEl.classList.add('colab-df-spinner');\n",
              "      try {\n",
              "        const charts = await google.colab.kernel.invokeFunction(\n",
              "            'suggestCharts', [key], {});\n",
              "      } catch (error) {\n",
              "        console.error('Error during call to suggestCharts:', error);\n",
              "      }\n",
              "      quickchartButtonEl.classList.remove('colab-df-spinner');\n",
              "      quickchartButtonEl.classList.add('colab-df-quickchart-complete');\n",
              "    }\n",
              "    (() => {\n",
              "      let quickchartButtonEl =\n",
              "        document.querySelector('#df-9ba6503e-e853-4c67-abf1-26f826d8e35b button');\n",
              "      quickchartButtonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "    })();\n",
              "  </script>\n",
              "</div>\n",
              "\n",
              "  <div id=\"id_df44800b-5406-4e1b-b0ec-2f77ba6e676f\">\n",
              "    <style>\n",
              "      .colab-df-generate {\n",
              "        background-color: #E8F0FE;\n",
              "        border: none;\n",
              "        border-radius: 50%;\n",
              "        cursor: pointer;\n",
              "        display: none;\n",
              "        fill: #1967D2;\n",
              "        height: 32px;\n",
              "        padding: 0 0 0 0;\n",
              "        width: 32px;\n",
              "      }\n",
              "\n",
              "      .colab-df-generate:hover {\n",
              "        background-color: #E2EBFA;\n",
              "        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n",
              "        fill: #174EA6;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate {\n",
              "        background-color: #3B4455;\n",
              "        fill: #D2E3FC;\n",
              "      }\n",
              "\n",
              "      [theme=dark] .colab-df-generate:hover {\n",
              "        background-color: #434B5C;\n",
              "        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n",
              "        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n",
              "        fill: #FFFFFF;\n",
              "      }\n",
              "    </style>\n",
              "    <button class=\"colab-df-generate\" onclick=\"generateWithVariable('data')\"\n",
              "            title=\"Generate code using this dataframe.\"\n",
              "            style=\"display:none;\">\n",
              "\n",
              "  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n",
              "       width=\"24px\">\n",
              "    <path d=\"M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z\"/>\n",
              "  </svg>\n",
              "    </button>\n",
              "    <script>\n",
              "      (() => {\n",
              "      const buttonEl =\n",
              "        document.querySelector('#id_df44800b-5406-4e1b-b0ec-2f77ba6e676f button.colab-df-generate');\n",
              "      buttonEl.style.display =\n",
              "        google.colab.kernel.accessAllowed ? 'block' : 'none';\n",
              "\n",
              "      buttonEl.onclick = () => {\n",
              "        google.colab.notebook.generateWithVariable('data');\n",
              "      }\n",
              "      })();\n",
              "    </script>\n",
              "  </div>\n",
              "\n",
              "    </div>\n",
              "  </div>\n"
            ],
            "text/plain": [
              "            user                                        item  label\n",
              "0     Tiagarajen            Samudra Boutique Hotel and Villa    6.0\n",
              "1       sandro_p            Samudra Boutique Hotel and Villa    6.0\n",
              "2        Yefta_I            Samudra Boutique Hotel and Villa    5.1\n",
              "3     Regina_T_C            Samudra Boutique Hotel and Villa    4.8\n",
              "4         Fiko_B            Samudra Boutique Hotel and Villa    5.1\n",
              "...          ...                                         ...    ...\n",
              "1995      Daud_Y  Le Meridien Bali Jimbaran - CHSE Certified   10.0\n",
              "1996   zatalia_r  Le Meridien Bali Jimbaran - CHSE Certified   10.0\n",
              "1997     Aulia_M  Le Meridien Bali Jimbaran - CHSE Certified    9.7\n",
              "1998     Aulia_M  Le Meridien Bali Jimbaran - CHSE Certified    9.7\n",
              "1999   Fieckaa_E  Le Meridien Bali Jimbaran - CHSE Certified    9.7\n",
              "\n",
              "[2000 rows x 3 columns]"
            ]
          },
          "execution_count": 9,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "data = pd.read_csv(url, encoding= 'unicode_escape', sep=\",\", names=[\"user\", \"item\", \"label\"])\n",
        "data"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "N6hBdhxYLP8L",
        "outputId": "bc0dd10a-6b19-47c5-ab9b-d606a7f6ea95"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "n_users: 1491, n_items: 200, data density: 0.5366 %\n"
          ]
        }
      ],
      "source": [
        "# split whole data into three folds for training, evaluating and testing\n",
        "train_data, eval_data, test_data = random_split(data, multi_ratios=[0.8, 0.1, 0.1])\n",
        "\n",
        "train_data, data_info = DatasetPure.build_trainset(train_data)\n",
        "eval_data = DatasetPure.build_evalset(eval_data)\n",
        "test_data = DatasetPure.build_testset(test_data)\n",
        "print(data_info)"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "hk8TlREsLSNe"
      },
      "outputs": [],
      "source": [
        "lightgcn = LightGCN(\n",
        "    task=\"ranking\",\n",
        "    data_info=data_info,\n",
        "    loss_type=\"bpr\",\n",
        "    embed_size=512,\n",
        "    n_epochs=100,\n",
        "    lr=5e-4,\n",
        "    batch_size=200,\n",
        "    num_neg=2,\n",
        "    device=\"cuda\",\n",
        "    reg=1e-4,\n",
        ")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true,
          "base_uri": "https://localhost:8080/"
        },
        "id": "c6hmKXhYLUX0",
        "outputId": "8962fbb5-8b02-43ea-cecf-08bbc6b93ad6"
      },
      "outputs": [
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Training start time: \u001b[35m2024-07-24 05:05:22\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:01<00:00, 12.73it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 1 elapsed: 1.274s\n",
            "\t \u001b[32mtrain_loss: 0.3495\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1110.49it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 79.55it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6872\n",
            "\t eval roc_auc: 0.6090\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0223\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.14it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 2 elapsed: 0.705s\n",
            "\t \u001b[32mtrain_loss: 0.3193\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 969.78it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 250.54it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6864\n",
            "\t eval roc_auc: 0.6246\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0208\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.59it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 3 elapsed: 0.612s\n",
            "\t \u001b[32mtrain_loss: 0.2893\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2131.25it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 132.79it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6853\n",
            "\t eval roc_auc: 0.6263\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 22.72it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 4 elapsed: 0.717s\n",
            "\t \u001b[32mtrain_loss: 0.2622\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1987.82it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 208.84it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6847\n",
            "\t eval roc_auc: 0.6315\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.49it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 5 elapsed: 0.635s\n",
            "\t \u001b[32mtrain_loss: 0.2366\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2024.28it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 134.18it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6840\n",
            "\t eval roc_auc: 0.6332\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 27.26it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 6 elapsed: 0.601s\n",
            "\t \u001b[32mtrain_loss: 0.2137\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2150.93it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 176.44it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6838\n",
            "\t eval roc_auc: 0.6263\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0188\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.14it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 7 elapsed: 0.653s\n",
            "\t \u001b[32mtrain_loss: 0.1923\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2124.77it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 313.64it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6829\n",
            "\t eval roc_auc: 0.6263\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0188\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.93it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 8 elapsed: 0.678s\n",
            "\t \u001b[32mtrain_loss: 0.1753\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 940.43it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 230.42it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6821\n",
            "\t eval roc_auc: 0.6298\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0188\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.73it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 9 elapsed: 0.609s\n",
            "\t \u001b[32mtrain_loss: 0.1586\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1306.64it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 252.64it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6815\n",
            "\t eval roc_auc: 0.6401\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.19it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 10 elapsed: 0.646s\n",
            "\t \u001b[32mtrain_loss: 0.1448\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1982.19it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 292.00it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6808\n",
            "\t eval roc_auc: 0.6488\n",
            "\t eval precision@10: 0.0000\n",
            "\t eval recall@10: 0.0000\n",
            "\t eval ndcg@10: 0.0000\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.48it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 11 elapsed: 0.693s\n",
            "\t \u001b[32mtrain_loss: 0.1328\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1322.71it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 246.38it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6801\n",
            "\t eval roc_auc: 0.6522\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.73it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 12 elapsed: 0.658s\n",
            "\t \u001b[32mtrain_loss: 0.1233\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 890.32it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 148.66it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6795\n",
            "\t eval roc_auc: 0.6609\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 22.33it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 13 elapsed: 0.737s\n",
            "\t \u001b[32mtrain_loss: 0.1136\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1047.79it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 170.63it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6791\n",
            "\t eval roc_auc: 0.6592\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.30it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 14 elapsed: 0.669s\n",
            "\t \u001b[32mtrain_loss: 0.106\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 879.68it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 318.57it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6786\n",
            "\t eval roc_auc: 0.6696\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0188\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 21.97it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 15 elapsed: 0.736s\n",
            "\t \u001b[32mtrain_loss: 0.1002\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 764.27it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 172.41it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6784\n",
            "\t eval roc_auc: 0.6730\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 21.09it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 16 elapsed: 0.769s\n",
            "\t \u001b[32mtrain_loss: 0.0953\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 562.47it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 71.53it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6781\n",
            "\t eval roc_auc: 0.6747\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0188\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 20.89it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 17 elapsed: 0.782s\n",
            "\t \u001b[32mtrain_loss: 0.0901\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1862.48it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 85.95it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6776\n",
            "\t eval roc_auc: 0.6782\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.51it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 18 elapsed: 0.663s\n",
            "\t \u001b[32mtrain_loss: 0.086\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1947.22it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 82.92it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6773\n",
            "\t eval roc_auc: 0.6713\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.33it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 19 elapsed: 0.621s\n",
            "\t \u001b[32mtrain_loss: 0.0828\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1341.75it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 308.54it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6768\n",
            "\t eval roc_auc: 0.6747\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0208\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.43it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 20 elapsed: 0.640s\n",
            "\t \u001b[32mtrain_loss: 0.0809\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2261.08it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 259.60it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6764\n",
            "\t eval roc_auc: 0.6765\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0208\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.02it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 21 elapsed: 0.657s\n",
            "\t \u001b[32mtrain_loss: 0.0777\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1277.58it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 172.80it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6761\n",
            "\t eval roc_auc: 0.6834\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0223\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.74it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 22 elapsed: 0.616s\n",
            "\t \u001b[32mtrain_loss: 0.0749\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 973.38it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 102.39it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6763\n",
            "\t eval roc_auc: 0.6834\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0223\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.29it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 23 elapsed: 0.644s\n",
            "\t \u001b[32mtrain_loss: 0.0736\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 935.81it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 245.24it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6766\n",
            "\t eval roc_auc: 0.6765\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0208\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.42it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 24 elapsed: 0.691s\n",
            "\t \u001b[32mtrain_loss: 0.072\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 987.36it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 102.41it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6764\n",
            "\t eval roc_auc: 0.6782\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.63it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 25 elapsed: 0.659s\n",
            "\t \u001b[32mtrain_loss: 0.0706\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2106.63it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 189.95it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6762\n",
            "\t eval roc_auc: 0.6799\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.29it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 26 elapsed: 0.624s\n",
            "\t \u001b[32mtrain_loss: 0.0694\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 995.56it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 320.67it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6758\n",
            "\t eval roc_auc: 0.6799\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 17.25it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 27 elapsed: 0.942s\n",
            "\t \u001b[32mtrain_loss: 0.0681\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 651.69it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 303.19it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6756\n",
            "\t eval roc_auc: 0.6782\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0188\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 20.18it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 28 elapsed: 0.802s\n",
            "\t \u001b[32mtrain_loss: 0.0673\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1880.85it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 298.21it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6760\n",
            "\t eval roc_auc: 0.6609\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.32it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 29 elapsed: 0.641s\n",
            "\t \u001b[32mtrain_loss: 0.0664\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 948.94it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 204.25it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6763\n",
            "\t eval roc_auc: 0.6574\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.88it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 30 elapsed: 0.613s\n",
            "\t \u001b[32mtrain_loss: 0.0651\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 965.32it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 98.43it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6763\n",
            "\t eval roc_auc: 0.6644\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0188\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.50it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 31 elapsed: 0.664s\n",
            "\t \u001b[32mtrain_loss: 0.0649\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1043.62it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 93.66it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6761\n",
            "\t eval roc_auc: 0.6557\n",
            "\t eval precision@10: 0.0000\n",
            "\t eval recall@10: 0.0000\n",
            "\t eval ndcg@10: 0.0000\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 21.88it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 32 elapsed: 0.744s\n",
            "\t \u001b[32mtrain_loss: 0.0648\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1895.30it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 272.07it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6756\n",
            "\t eval roc_auc: 0.6644\n",
            "\t eval precision@10: 0.0000\n",
            "\t eval recall@10: 0.0000\n",
            "\t eval ndcg@10: 0.0000\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 22.72it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 33 elapsed: 0.717s\n",
            "\t \u001b[32mtrain_loss: 0.0641\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2349.75it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 141.06it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6754\n",
            "\t eval roc_auc: 0.6592\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 20.74it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 34 elapsed: 0.784s\n",
            "\t \u001b[32mtrain_loss: 0.0639\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 736.49it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 280.67it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6751\n",
            "\t eval roc_auc: 0.6644\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 20.43it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 35 elapsed: 0.793s\n",
            "\t \u001b[32mtrain_loss: 0.063\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1540.89it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 196.87it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6747\n",
            "\t eval roc_auc: 0.6696\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 27.14it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 36 elapsed: 0.599s\n",
            "\t \u001b[32mtrain_loss: 0.063\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1848.53it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 196.45it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6745\n",
            "\t eval roc_auc: 0.6696\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0181\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.90it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 37 elapsed: 0.608s\n",
            "\t \u001b[32mtrain_loss: 0.0637\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1097.41it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 183.04it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6741\n",
            "\t eval roc_auc: 0.6765\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0197\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.65it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 38 elapsed: 0.692s\n",
            "\t \u001b[32mtrain_loss: 0.0622\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 974.29it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 201.19it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6739\n",
            "\t eval roc_auc: 0.6782\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0378\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.26it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 39 elapsed: 0.656s\n",
            "\t \u001b[32mtrain_loss: 0.062\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 890.13it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 315.01it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6737\n",
            "\t eval roc_auc: 0.6765\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0369\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.18it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 40 elapsed: 0.644s\n",
            "\t \u001b[32mtrain_loss: 0.0628\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1105.80it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 79.35it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6735\n",
            "\t eval roc_auc: 0.6782\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0188\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.17it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 41 elapsed: 0.702s\n",
            "\t \u001b[32mtrain_loss: 0.0612\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1376.99it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 91.42it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6731\n",
            "\t eval roc_auc: 0.6799\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0369\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 21.93it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 42 elapsed: 0.740s\n",
            "\t \u001b[32mtrain_loss: 0.0617\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 941.69it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 317.03it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6729\n",
            "\t eval roc_auc: 0.6817\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0369\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.82it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 43 elapsed: 0.652s\n",
            "\t \u001b[32mtrain_loss: 0.0611\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 979.75it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 247.92it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6729\n",
            "\t eval roc_auc: 0.6903\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0376\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.27it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 44 elapsed: 0.674s\n",
            "\t \u001b[32mtrain_loss: 0.0606\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1760.83it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 249.60it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6729\n",
            "\t eval roc_auc: 0.6920\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0376\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.14it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 45 elapsed: 0.704s\n",
            "\t \u001b[32mtrain_loss: 0.0615\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1835.58it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 185.09it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6729\n",
            "\t eval roc_auc: 0.6851\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0385\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.01it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 46 elapsed: 0.624s\n",
            "\t \u001b[32mtrain_loss: 0.0602\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1877.49it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 218.89it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6723\n",
            "\t eval roc_auc: 0.6869\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0385\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.87it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 47 elapsed: 0.677s\n",
            "\t \u001b[32mtrain_loss: 0.0612\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1974.72it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 97.86it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6721\n",
            "\t eval roc_auc: 0.6920\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0389\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.59it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 48 elapsed: 0.634s\n",
            "\t \u001b[32mtrain_loss: 0.0605\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2078.45it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 241.27it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6718\n",
            "\t eval roc_auc: 0.6886\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0389\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 21.58it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 49 elapsed: 0.749s\n",
            "\t \u001b[32mtrain_loss: 0.061\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1218.57it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 279.30it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6719\n",
            "\t eval roc_auc: 0.6817\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0389\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 20.39it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 50 elapsed: 0.798s\n",
            "\t \u001b[32mtrain_loss: 0.0605\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1015.08it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 311.33it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6720\n",
            "\t eval roc_auc: 0.6817\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0389\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 21.88it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 51 elapsed: 0.739s\n",
            "\t \u001b[32mtrain_loss: 0.0607\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 921.02it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 88.29it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6720\n",
            "\t eval roc_auc: 0.6869\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0208\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 19.92it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 52 elapsed: 0.812s\n",
            "\t \u001b[32mtrain_loss: 0.0599\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 774.29it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 89.19it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6721\n",
            "\t eval roc_auc: 0.6834\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0223\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 20.76it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 53 elapsed: 0.787s\n",
            "\t \u001b[32mtrain_loss: 0.06\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1973.79it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 50.22it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6723\n",
            "\t eval roc_auc: 0.6765\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0208\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.66it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 54 elapsed: 0.694s\n",
            "\t \u001b[32mtrain_loss: 0.0604\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 711.26it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 199.38it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6720\n",
            "\t eval roc_auc: 0.6799\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0389\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.24it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 55 elapsed: 0.618s\n",
            "\t \u001b[32mtrain_loss: 0.0603\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1357.38it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 214.58it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6720\n",
            "\t eval roc_auc: 0.6799\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0389\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.49it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 56 elapsed: 0.616s\n",
            "\t \u001b[32mtrain_loss: 0.0599\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 500.10it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 325.57it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6723\n",
            "\t eval roc_auc: 0.6834\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0403\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 27.47it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 57 elapsed: 0.592s\n",
            "\t \u001b[32mtrain_loss: 0.0608\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2095.06it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 292.33it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6722\n",
            "\t eval roc_auc: 0.6834\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.63it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 58 elapsed: 0.631s\n",
            "\t \u001b[32mtrain_loss: 0.0601\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2425.86it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 245.64it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6721\n",
            "\t eval roc_auc: 0.6765\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.09it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 59 elapsed: 0.632s\n",
            "\t \u001b[32mtrain_loss: 0.0606\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1907.37it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 70.78it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6716\n",
            "\t eval roc_auc: 0.6782\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.79it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 60 elapsed: 0.633s\n",
            "\t \u001b[32mtrain_loss: 0.0608\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1782.53it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 204.57it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6716\n",
            "\t eval roc_auc: 0.6782\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.52it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 61 elapsed: 0.618s\n",
            "\t \u001b[32mtrain_loss: 0.0598\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 863.03it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 180.84it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6712\n",
            "\t eval roc_auc: 0.6886\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.02it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 62 elapsed: 0.625s\n",
            "\t \u001b[32mtrain_loss: 0.0605\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1783.29it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 248.92it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6712\n",
            "\t eval roc_auc: 0.6920\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.26it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 63 elapsed: 0.672s\n",
            "\t \u001b[32mtrain_loss: 0.0594\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 963.76it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 84.58it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6716\n",
            "\t eval roc_auc: 0.6799\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.96it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 64 elapsed: 0.648s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1250.91it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 151.20it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6718\n",
            "\t eval roc_auc: 0.6730\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0422\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.81it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 65 elapsed: 0.652s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2013.59it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 218.72it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6726\n",
            "\t eval roc_auc: 0.6713\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.41it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 66 elapsed: 0.622s\n",
            "\t \u001b[32mtrain_loss: 0.0603\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 284.63it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 119.76it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6722\n",
            "\t eval roc_auc: 0.6713\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0422\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.56it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 67 elapsed: 0.636s\n",
            "\t \u001b[32mtrain_loss: 0.0594\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1039.74it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 84.57it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6724\n",
            "\t eval roc_auc: 0.6696\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0422\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.32it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 68 elapsed: 0.663s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 858.43it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 148.58it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6722\n",
            "\t eval roc_auc: 0.6661\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0422\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 21.10it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 69 elapsed: 0.772s\n",
            "\t \u001b[32mtrain_loss: 0.0597\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1014.59it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 336.46it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6720\n",
            "\t eval roc_auc: 0.6696\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 22.06it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 70 elapsed: 0.738s\n",
            "\t \u001b[32mtrain_loss: 0.0594\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 928.97it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 306.04it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6719\n",
            "\t eval roc_auc: 0.6661\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 20.98it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 71 elapsed: 0.776s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1002.70it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 86.97it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6718\n",
            "\t eval roc_auc: 0.6678\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 19.90it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 72 elapsed: 0.813s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 965.54it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 94.61it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6721\n",
            "\t eval roc_auc: 0.6678\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0269\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 21.62it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 73 elapsed: 0.757s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1683.11it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 211.45it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6723\n",
            "\t eval roc_auc: 0.6626\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0450\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.85it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 74 elapsed: 0.652s\n",
            "\t \u001b[32mtrain_loss: 0.06\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1989.71it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 295.77it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6723\n",
            "\t eval roc_auc: 0.6644\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0450\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.99it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 75 elapsed: 0.650s\n",
            "\t \u001b[32mtrain_loss: 0.0586\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2019.40it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 373.89it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6717\n",
            "\t eval roc_auc: 0.6678\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0269\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.37it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 76 elapsed: 0.667s\n",
            "\t \u001b[32mtrain_loss: 0.059\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 475.81it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 297.62it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6709\n",
            "\t eval roc_auc: 0.6782\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.43it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 77 elapsed: 0.611s\n",
            "\t \u001b[32mtrain_loss: 0.0587\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1850.97it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 43.24it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6709\n",
            "\t eval roc_auc: 0.6799\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0269\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.55it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 78 elapsed: 0.612s\n",
            "\t \u001b[32mtrain_loss: 0.0592\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1929.30it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 172.83it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6712\n",
            "\t eval roc_auc: 0.6730\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0269\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.74it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 79 elapsed: 0.637s\n",
            "\t \u001b[32mtrain_loss: 0.059\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1050.15it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 325.67it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6710\n",
            "\t eval roc_auc: 0.6730\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0269\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.55it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 80 elapsed: 0.685s\n",
            "\t \u001b[32mtrain_loss: 0.0592\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 498.08it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 264.73it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6712\n",
            "\t eval roc_auc: 0.6713\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0269\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.65it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 81 elapsed: 0.695s\n",
            "\t \u001b[32mtrain_loss: 0.0591\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1387.92it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 245.83it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6719\n",
            "\t eval roc_auc: 0.6678\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0269\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.31it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 82 elapsed: 0.616s\n",
            "\t \u001b[32mtrain_loss: 0.059\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1983.12it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 225.20it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6720\n",
            "\t eval roc_auc: 0.6609\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 26.24it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 83 elapsed: 0.618s\n",
            "\t \u001b[32mtrain_loss: 0.0594\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1515.28it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 216.59it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6720\n",
            "\t eval roc_auc: 0.6626\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0493\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 22.49it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 84 elapsed: 0.720s\n",
            "\t \u001b[32mtrain_loss: 0.06\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1992.54it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 258.11it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6724\n",
            "\t eval roc_auc: 0.6644\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0493\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.74it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 85 elapsed: 0.682s\n",
            "\t \u001b[32mtrain_loss: 0.0584\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 966.88it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 168.68it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6726\n",
            "\t eval roc_auc: 0.6626\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0493\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.23it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 86 elapsed: 0.674s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2040.03it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 433.12it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6728\n",
            "\t eval roc_auc: 0.6661\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0493\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 20.42it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 87 elapsed: 0.793s\n",
            "\t \u001b[32mtrain_loss: 0.0595\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1026.25it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 95.49it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6727\n",
            "\t eval roc_auc: 0.6730\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0493\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 19.98it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 88 elapsed: 0.815s\n",
            "\t \u001b[32mtrain_loss: 0.0592\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 368.31it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 326.40it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6723\n",
            "\t eval roc_auc: 0.6747\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0493\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 18.30it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 89 elapsed: 0.883s\n",
            "\t \u001b[32mtrain_loss: 0.0589\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1054.64it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 336.16it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6720\n",
            "\t eval roc_auc: 0.6730\n",
            "\t eval precision@10: 0.0125\n",
            "\t eval recall@10: 0.1250\n",
            "\t eval ndcg@10: 0.0493\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 17.46it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 90 elapsed: 0.923s\n",
            "\t \u001b[32mtrain_loss: 0.0586\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 926.92it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 303.56it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6721\n",
            "\t eval roc_auc: 0.6696\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 22.53it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 91 elapsed: 0.718s\n",
            "\t \u001b[32mtrain_loss: 0.0589\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 945.30it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 287.16it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6718\n",
            "\t eval roc_auc: 0.6696\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.78it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 92 elapsed: 0.635s\n",
            "\t \u001b[32mtrain_loss: 0.0587\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1332.37it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 104.12it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6716\n",
            "\t eval roc_auc: 0.6713\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.19it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 93 elapsed: 0.669s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 890.70it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 173.28it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6710\n",
            "\t eval roc_auc: 0.6713\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.52it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 94 elapsed: 0.698s\n",
            "\t \u001b[32mtrain_loss: 0.0601\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2066.16it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 217.66it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6707\n",
            "\t eval roc_auc: 0.6747\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.16it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 95 elapsed: 0.676s\n",
            "\t \u001b[32mtrain_loss: 0.0587\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 971.13it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 157.97it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6708\n",
            "\t eval roc_auc: 0.6661\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.17it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 96 elapsed: 0.706s\n",
            "\t \u001b[32mtrain_loss: 0.0581\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 587.03it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 60.59it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6709\n",
            "\t eval roc_auc: 0.6609\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 23.44it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 97 elapsed: 0.692s\n",
            "\t \u001b[32mtrain_loss: 0.059\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 984.81it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 262.62it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6703\n",
            "\t eval roc_auc: 0.6644\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.08it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 98 elapsed: 0.679s\n",
            "\t \u001b[32mtrain_loss: 0.0582\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 2138.86it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 203.80it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6705\n",
            "\t eval roc_auc: 0.6661\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0312\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 25.26it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 99 elapsed: 0.643s\n",
            "\t \u001b[32mtrain_loss: 0.0587\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1889.33it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 166.73it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6708\n",
            "\t eval roc_auc: 0.6626\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0269\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "train: 100%|██████████| 16/16 [00:00<00:00, 24.20it/s]\n"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "Epoch 100 elapsed: 0.678s\n",
            "\t \u001b[32mtrain_loss: 0.0593\u001b[0m\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1428.09it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 201.15it/s]"
          ]
        },
        {
          "name": "stdout",
          "output_type": "stream",
          "text": [
            "\t eval log_loss: 0.6713\n",
            "\t eval roc_auc: 0.6644\n",
            "\t eval precision@10: 0.0063\n",
            "\t eval recall@10: 0.0625\n",
            "\t eval ndcg@10: 0.0242\n",
            "==============================\n"
          ]
        },
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "\n"
          ]
        }
      ],
      "source": [
        "# monitor metrics on eval data during training\n",
        "model = lightgcn.fit(\n",
        "    train_data,\n",
        "    neg_sampling=True,\n",
        "    verbose=2,\n",
        "    eval_data=eval_data,\n",
        "    metrics=[\"loss\", \"roc_auc\", \"precision\", \"recall\", \"ndcg\"],\n",
        ")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "background_save": true
        },
        "id": "19pa3tr1LWTN",
        "outputId": "80a6b28f-97d8-4003-dcbc-67960ad60e10"
      },
      "outputs": [
        {
          "name": "stderr",
          "output_type": "stream",
          "text": [
            "eval_pointwise: 100%|██████████| 1/1 [00:00<00:00, 1906.50it/s]\n",
            "eval_listwise: 100%|██████████| 1/1 [00:00<00:00, 163.29it/s]\n"
          ]
        },
        {
          "data": {
            "text/plain": [
              "{'loss': 0.6014766986616328,\n",
              " 'roc_auc': 0.8100189035916824,\n",
              " 'precision': 0.022727272727272728,\n",
              " 'recall': 0.22727272727272727,\n",
              " 'ndcg': 0.17213107932642796}"
            ]
          },
          "execution_count": 13,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "# do final evaluation on test data\n",
        "evaluate(\n",
        "    model=lightgcn,\n",
        "    data=test_data,\n",
        "    neg_sampling=True,\n",
        "    metrics=[\"loss\", \"roc_auc\", \"precision\", \"recall\", \"ndcg\"],\n",
        ")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "BIGZSVtz6yXq",
        "outputId": "5f83661f-5496-4a1e-90fe-59ee2c285ce8"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "array([0.48710105], dtype=float32)"
            ]
          },
          "execution_count": 18,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "# predict preference of user Fieckaa_E to item Le Meridien Bali\n",
        "lightgcn.predict(user=\"Fieckaa_E\", item=\"Le Meridien Bali\")"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "colab": {
          "base_uri": "https://localhost:8080/"
        },
        "id": "VYSyiEh97Isd",
        "outputId": "1aaed6b5-5db9-4843-d0f1-df96f1e0af68"
      },
      "outputs": [
        {
          "data": {
            "text/plain": [
              "{'Fieckaa_E': array(['Holiday Inn BALI SANUR', 'RV Hotel Kutus Kutus',\n",
              "        'Hotel Santika Seminyak', 'Amaris Teuku Umar Denpasar',\n",
              "        'Dream of Aventus Hotel Kuta'], dtype='<U27')}"
            ]
          },
          "execution_count": 19,
          "metadata": {},
          "output_type": "execute_result"
        }
      ],
      "source": [
        "# recommend 7 items for user Fieckaa_E\n",
        "lightgcn.recommend_user(user=\"Fieckaa_E\", n_rec=200)"
      ]
    }
  ],
  "metadata": {
    "colab": {
      "provenance": []
    },
    "kernelspec": {
      "display_name": "Python 3",
      "name": "python3"
    },
    "language_info": {
      "name": "python"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 0
}